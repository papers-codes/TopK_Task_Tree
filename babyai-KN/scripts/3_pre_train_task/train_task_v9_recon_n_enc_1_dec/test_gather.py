import torch

ori = torch.rand(3,100,2000)
import pdb
pdb.set_trace()



# ori = torch.rand(3,1,2,3) 
# print(ori)
# print('----------------------------------------------')
# aa = torch.randint(0, 2, (1,2,1))  # 1.2.1 
# print(aa.shape, aa)
# print('----------------------------------------------')
# aa_ = torch.repeat_interleave(aa, ori.shape[-1], dim=-1) # 1.2.3
# print(aa_.shape, aa_)
# print('----------------------------------------------')
# print('----------------------------------------------')


# import pdb
# pdb.set_trace()

# res = ori.gather(0, aa_[None])[0]  ## 3.1.2.3  1.1.2.3 --> 1.1.2.3
# print(res.shape, res)
# print('----------------------------------------------')
# print('----------------------------------------------')

# print(ori[aa[0,0,0]])
# print(ori[aa[0,1,0]])

# # tensor([[[[0.9126, 0.5590, 0.1053],
# #           [0.4784, 0.6557, 0.8363]]],
# #         [[[0.5957, 0.3712, 0.8660],
# #           [0.6050, 0.8034, 0.1657]]],
# #         [[[0.3417, 0.9261, 0.3206],
# #           [0.8191, 0.6062, 0.9265]]]])
# # ----------------------------------------------
# # torch.Size([1, 2, 1]) 
# # tensor([[[1],
# #          [1]]])
# # ----------------------------------------------
# # torch.Size([1, 2, 3]) 
# # tensor([[[1, 1, 1],
# #          [1, 1, 1]]])
# # ----------------------------------------------
# # torch.Size([1, 2, 3]) 
# # 
# # tensor([[[0.5957, 0.3712, 0.8660],
# #          [0.6050, 0.8034, 0.1657]]])